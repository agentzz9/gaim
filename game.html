<html><head><style>
canvas {
    border:1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style></head><body></body>
<script src="./Objects.js"></script>
<script type="text/javascript">
var PLAYER, goal;
var leftWall, rightWall;
var sideline1, sideline2;
var roadlines = [];
var gameArea = {
	canvas: document.createElement("canvas"),
    
    start : function() {
        this.canvas.width = 1320;
        this.canvas.height = 600;
        this.canvas.style = "background-color:#404142";
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        this.frameNo = 0;
        window.addEventListener('keydown', function (e) {
            e.preventDefault();//prevent scroll of window :(
            gameArea.keys = (gameArea.keys || []);
            gameArea.keys[e.keyCode] = true;
        })
        window.addEventListener('keyup', function (e) {
            gameArea.keys[e.keyCode] = false; 
        })
        this.interval = setInterval(updateGameArea, 20);

    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
        //this.controlContext.clearRect(); .... needed ?
    },
    stop : function() {
        clearInterval(this.interval);
    }
}

function everyinterval(n) {
    if ((gameArea.frameNo / n) % 1 == 0) {return true;}
    return false;
}


function updateGameArea(){

	/*detect collisions, win/lose conditions, parse inputs, 
		trigger random obstacles ?, set speeds of components
	*/
    for(i=0; i<roadlines.length; i+=1){
    
    }

    if (gameArea.keys && gameArea.keys[37]) {moveLeft(); }
    if (gameArea.keys && gameArea.keys[39]) {moveRight(); }
    if (gameArea.keys && !gameArea.keys[37] && !gameArea.keys[39]){
        moveLeftRight();//no left/right reset steer to straight
    }
    if (gameArea.keys && gameArea.keys[38]) {
        moveUp();
    }
    if(gameArea.keys && !gameArea.keys[38]){
        moveUpDown();    //placeholder logic to reset fwd movement for now.
    }
    if (gameArea.keys && gameArea.keys[40]) {//brakes?
    }


	gameArea.clear();
	gameArea.frameNo += 1;
	//console.log(gameArea.frameNo);
	/*
	update components.redraw frame
	*/
    
    for(i=0; i<roadlines.length; i+=1){
      roadlines[i].newPos();
      roadlines[i].update();
    }
    leftWall.newPos();
    leftWall.update();
    rightWall.newPos();
    rightWall.update();
    sideline1.newPos();
    sideline1.update();
    sideline2.newPos();
    sideline2.update();

    PLAYER.newPos();
    PLAYER.update();
	
}
function moveLeft(){
    PLAYER.speedX = -10;
}
function moveRight(){
    PLAYER.speedX = +10;
}
function moveLeftRight(){
    PLAYER.speedX = 0;
}
function moveUp(){
    for(i=0; i<roadlines.length; i+=1){
        roadlines[i].speedY  = +10; 
    }
}
function moveUpDown(){
    for(i=0; i<roadlines.length; i+=1){
        roadlines[i].speedY  = 0; 
    }
}
function startGame(){
	
	//initialize objects,
//	PLAYER  = new Component(216/3, 490/3, "car", 10, 10, "image");
    PLAYER  = new Component(216/3, 490/3, "red", gameArea.canvas.width/2 ,
            gameArea.canvas.height*0.70);
 
    leftWall = new Component(gameArea.canvas.width*.33, 2000, "green", 0, -10);

    rightWall = new Component(gameArea.canvas.width*.33, 2000, "green",
            gameArea.canvas.width*.67, -10);
    sideline1 = new Component(15, 3000, "white", (gameArea.canvas.width*.33)+6,
            -10);
    sideline2 = new Component(15, 3000, "white",
            (gameArea.canvas.width*.67)-21,-10);
    roadline = new Component(15, 160, "white", (gameArea.canvas.width*.5)-6,10);
    roadlines.push(roadline);
    /*uparrow = new component(150, 150, "uparrow", 100, 960, "image");
    downarrow = new component(150, 150, "downarrow", 100, 960+150, "image");
    leftarrow = new component(150, 150, "leftarrow", 100+350, 990, "image");
    rightarrow = new component(150, 150, "rightarrow", 100+350+170, 990, "image");
    bottomLine = new component(2000, 5, "black", 0, 950);//the len = 2000 behaves wierd. canvas.width not working :(*/

    gameArea.start();

}
function stopGame(){
	gameArea.stop();
}
</script>
<button onclick="startGame()">startgame</button>
<button onclick="stopGame()">stopgame</button>
<img hidden id="car" src="carimage.png"/>
 
<!-- <img hidden id="uparrow" src="uparrow.png"/>
<img hidden id="downarrow" src="downarrow.png"/>
<img hidden id="leftarrow" src="leftarrow.png"/>
<img hidden id="rightarrow" src="rightarrow.png"/> -->

 
</html>
